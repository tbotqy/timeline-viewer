$(function(){var g=getUserAgent();var h=['chrome','safari','firefox'];var i=false;setTimeout(function(){$.getScript('/js/twitter_follow_button.js');$.getScript('/js/twitter_tweet_button.js');$.getScript('//b.st-hatena.com/js/bookmark_button.js');facebook(document,'script','facebook-jssdk')},3000);$("#wrap-timeline-lower").on("click",".status-content",function(e){var a=$(e.target);if(!a.is('a')&&!a.is('i')){$(this).find(".bottom").slideToggle('fast')}});$("#wrap-timeline-lower").on("click",".status-content .link-delete a",function(e){e.preventDefault();if(confirm('ツイートを削除します。よろしいですか？')){var b=$(this).parent().data('status-id');$.ajax({url:"/ajax/delete_status",type:"post",data:{"status_id_to_delete":b},dataType:"json",success:function(a){if(a.owns){if(a.deleted){$("div[data-status-id="+b+"]").fadeOut()}else{alert("ごめんなさい。削除に失敗しました。画面をリロードしてもう一度お試しください。")}}else{alert("不正な操作です。")}},error:function(){alert("エラーが発生しました。")}})}});$("#wrap-timeline-lower").on("click","#read-more",function(e){var b=$(this);e.preventDefault();var c=b.offset().top;b.button('loading');var d=$(".oldest-timestamp");var f=d.val();$.ajax({type:"POST",dataType:"html",data:{"oldest_timestamp":f,"destination_action_type":detectActionType(location.pathname)},url:'/ajax/read_more',success:function(a){d.remove();$("#wrap-read-more").remove();$(".wrap-one-result:last").after(a)},error:function(a){alert("読み込みに失敗しました。")},complete:function(){scrollDownToDestination(e,c)}})});var j=$(".wrap-progress-bar");var k=$("#start-import");k.click(function(){k.button('loading');showLoader("#wrap-import");j.fadeIn(function(){$("#status").fadeIn()});var a={"id_str_oldest":""};getStatuses(a)});var l=$(".error-inner");l.find(".description").click(function(e){e.preventDefault();l.find(".invite-friends").fadeIn()});l.find(".invite-friends .close").click(function(e){e.preventDefault();l.find(".invite-friends").fadeOut()});$("#update-profile").click(function(){var a=$(this);a.button('loading');a.after("<img class=\"loader\" src=\"/img/ajax-loader.gif\" />");$(".wrap-profile").find(".loader").fadeIn();checkProfileUpdate()});$("#update-statuses").click(function(){var a=$(this);a.button('loading');a.after("<img class=\"loader\" src=\"/img/ajax-loader.gif\" />");$(".tweets").find(".loader").fadeIn();checkStatusUpdate()});$("#update-friends").click(function(){var a=$(this);a.button('loading');a.after("<img class=\"loader\" src=\"/img/ajax-loader.gif\" />");$(".friends").find(".loader").fadeIn();checkFriendUpdate()});var m="";$("#delete-account").click(function(){var b=$("#modal-delete-account");b.find(".modal-header .close").fadeOut();b.find(".modal-footer .cancel-delete").addClass("disabled");$(this).button('loading');b.find(".status").fadeOut(function(){$(this).html("処理中...<img src=\"/img/ajax-loader.gif\" class=\"loader\" />")}).fadeIn();$.ajax({url:'/ajax/deactivate_account',type:'post',dataType:'json',success:function(a){m=a.deleted;showDeleteCompleteMessage(a.deleted)},error:function(){showDeleteErrorMessage()},complete:function(){if(m){setTimeout(function(){redirect()},3000)}else{alert("処理がうまくいきませんでした。")}}})});$(window).scroll(function(){var a=$(document).scrollTop();var b=$(".to-page-top");if(a>=200){b.fadeIn()}else{b.fadeOut()}});$(".to-page-top").find("a").click(function(e){scrollToPageTop(e)})});
