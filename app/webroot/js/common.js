$(function(){var k=getUserAgent();var l=['chrome','safari','firefox'];var m=false;setTimeout(function(){$.getScript('/js/twitter_follow_button.js');$.getScript('/js/twitter_tweet_button.js');$.getScript('//b.st-hatena.com/js/bookmark_button.js');facebook(document,'script','facebook-jssdk')},3000);$("#wrap-timeline").on("click",".status-content",function(e){var a=$(e.target);if(!a.is('a')&&!a.is('i')){$(this).find(".bottom").slideToggle('fast')}});$("#wrap-timeline").on("click",".status-content .link-delete a",function(e){e.preventDefault();if(confirm('ツイートを削除します。よろしいですか？')){var b=$(this).parent().data('status-id');$.ajax({url:"/ajax/delete_status",type:"post",data:{"status_id_to_delete":b},dataType:"json",success:function(a){if(a.owns){if(a.deleted){$("div[data-status-id="+b+"]").fadeOut()}else{alert("ごめんなさい。削除に失敗しました。画面をリロードしてもう一度お試しください。")}}else{alert("不正な操作です。")}},error:function(){alert("エラーが発生しました。")}})}});$("#wrap-timeline").on("click","#read-more",function(e){var b=$(this);e.preventDefault();var c=b.offset().top;b.button('loading');var d=$("#oldest-timestamp");$.ajax({type:"POST",dataType:"html",data:{"oldest_timestamp":d.attr("value"),"destination_action_type":detectActionType(location.pathname)},url:'/ajax/read_more',success:function(a){d.remove();$("#wrap-read-more").remove();$(".wrap-each-status:last").after(a)},error:function(a){alert("読み込みに失敗しました。")},complete:function(){scrollDownToDestination(e,c)}})});var n=$(".wrap-progress-bar");var o=$("#start-import");o.click(function(){o.button('loading');showLoader("#wrap-import");n.fadeIn(function(){$("#status").fadeIn()});var a={"id_str_oldest":""};getStatuses(a)});var p=$(".error-inner");p.find(".description").click(function(e){e.preventDefault();p.find(".invite-friends").fadeIn()});p.find(".invite-friends .close").click(function(e){e.preventDefault();p.find(".invite-friends").fadeOut()});$("#update-profile").click(function(){var a=$(this);a.button('loading');a.after("<img class=\"loader\" src=\"/img/ajax-loader.gif\" />");$(".wrap-profile").find(".loader").fadeIn();checkProfileUpdate()});$("#update-statuses").click(function(){var a=$(this);a.button('loading');a.after("<img class=\"loader\" src=\"/img/ajax-loader.gif\" />");$(".tweets").find(".loader").fadeIn();checkStatusUpdate()});$("#update-friends").click(function(){var a=$(this);a.button('loading');a.after("<img class=\"loader\" src=\"/img/ajax-loader.gif\" />");$(".friends").find(".loader").fadeIn();checkFriendUpdate()});var q="";$("#delete-account").click(function(){var b=$("#modal-delete-account");b.find(".modal-header .close").fadeOut();b.find(".modal-footer .cancel-delete").addClass("disabled");$(this).button('loading');b.find(".status").fadeOut(function(){$(this).html("処理中...<img src=\"/img/ajax-loader.gif\" class=\"loader\" />")}).fadeIn();$.ajax({url:'/ajax/delete_account',type:'post',dataType:'json',success:function(a){q=a.deleted;showDeleteCompleteMessage(a.deleted)},error:function(){showDeleteErrorMessage()},complete:function(){if(q){setTimeout(function(){redirect()},3000)}else{alert("処理がうまくいきませんでした。")}}})});$(window).scroll(function(){var a=$(document).scrollTop();var b=$(".to-page-top");if(a>=200){b.fadeIn()}else{b.fadeOut()}});$(".to-page-top").find("a").click(function(e){scrollToPageTop(e)});$(".list-years").find("li").mouseover(function(){var a=$(this);$(".list-years").find("a").removeClass("btn-primary selected");a.find('a').addClass("btn-primary selected");$("#wrap-list-months").find("ul").css('display','none');$("#wrap-list-days").find("ul").css('display','none');var b=a.attr('data-date');$("#wrap-list-months").find("."+b).css('display','block')});$(".list-months").find("li").mouseover(function(){var a=$(this);$(".list-months").find("li").find("a").removeClass("btn-primary selected");a.find('a').addClass("btn-primary selected");$("#wrap-list-days").find("ul").css('display','none');var b=a.attr('data-date');$("#wrap-list-days").find("."+b).css('display','block')});if('pushState'in history){$("#wrap-term-selectors").find("a").click(function(e){var b=$(this);e.preventDefault();var c=b.attr('href');var d=b.attr('data-date');var f=b.attr('data-date-type');var g=$("#wrap-timeline");g.html("<div class=\"cover\"><span>Loading</span></div>");var h=g.find('.cover');h.css("height",200);h.animate({opacity:0.8},200);var i=location.pathname;var j=detectActionType(i);$.ajax({type:'GET',dataType:'html',url:'/ajax/switch_term',data:{"date":d,"date_type":f,"action_type":j},success:function(a){$("#wrap-main").html(a)},error:function(a){alert("読み込みに失敗しました。画面をリロードしてください")},complete:function(){scrollToPageTop(e);$("#wrap-main").fadeIn('fast');$("#wrap-term-selectors").find("a").button('complete');window.history.pushState(null,null,c)}})})}$("#wrap-list-years").find("a").click(function(){$("#wrap-list-months").find(".selected").removeClass("selected btn-primary");$("#wrap-list-days").find(".selected").removeClass("selected btn-primary");$(this).addClass("selected btn-primary")});$("#wrap-list-months").find("a").click(function(){$("#wrap-list-days").find(".selected").removeClass("selected btn-primary");$(this).addClass("selected btn-primary")});$("#wrap-list-days").find("a").click(function(){$("#wrap-list-days").find(".selected").removeClass("selected btn-primary");$(this).addClass("selected btn-primary")})});
