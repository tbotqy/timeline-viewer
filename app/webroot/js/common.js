$(function(){var j=getUserAgent();var k=['chrome','safari','firefox'];var l=false;setTimeout(function(){$.getScript('/js/twitter_follow_button.js');$.getScript('/js/twitter_tweet_button.js');$.getScript('//b.st-hatena.com/js/bookmark_button.js');facebook(document,'script','facebook-jssdk')},3000);$(".status-content").live("click",function(e){var a=$(e.target);if(!a.is('a')&&!a.is('i')){$(this).find(".bottom").slideToggle('fast')}});$(".status-content").find(".link-delete a").live("click",function(e){e.preventDefault();if(confirm('ツイートを削除します。よろしいですか？')){var b=$(this).parent().data('status-id');$.ajax({url:"/ajax/delete_status",type:"post",data:{"status_id_to_delete":b},dataType:"json",success:function(a){if(a.owns){if(a.deleted){$("div[data-status-id="+b+"]").fadeOut()}else{alert("ごめんなさい。削除に失敗しました。画面をリロードしてもう一度お試しください。")}}else{alert("不正な操作です。")}},error:function(){alert("エラーが発生しました。")}})}});$("#read-more").live("click",function(e){e.preventDefault();var b=$(this).offset().top;$(this).button('loading');$.ajax({type:"POST",dataType:"html",data:{"oldest_timestamp":$("#oldest-timestamp").attr("value"),"destination_action_type":detectActionType(location.pathname)},url:'/ajax/read_more',success:function(a){$("#oldest-timestamp").remove();$("#wrap-read-more").remove();$(".wrap-each-status:last").after(a)},error:function(a){alert("読み込みに失敗しました。")},complete:function(){scrollDownToDestination(e,b)}})});var m=$(".wrap-progress-bar");var n=$("#start-import");n.click(function(){n.button('loading');showLoader("#wrap-import");m.fadeIn(function(){$("#status").fadeIn()});var a={"id_str_oldest":""};getStatuses(a)});$(".error-inner").find(".description").click(function(e){e.preventDefault();$(".error-inner").find(".invite-friends").fadeIn()});$(".error-inner").find(".invite-friends .close").click(function(e){e.preventDefault();$(".error-inner").find(".invite-friends").fadeOut()});$("#update-profile").click(function(){$(this).button('loading');$(this).after("<img class=\"loader\" src=\"/img/ajax-loader.gif\" />");$(".wrap-profile").find(".loader").fadeIn();checkProfileUpdate()});$("#update-statuses").click(function(){$(this).button('loading');$(this).after("<img class=\"loader\" src=\"/img/ajax-loader.gif\" />");$(".tweets").find(".loader").fadeIn();checkStatusUpdate()});$("#update-friends").click(function(){$(this).button('loading');$(this).after("<img class=\"loader\" src=\"/img/ajax-loader.gif\" />");$(".friends").find(".loader").fadeIn();checkFriendUpdate()});var o="";$("#delete-account").click(function(){$("#modal-delete-account").find(".modal-header .close").fadeOut();$("#modal-delete-account").find(".modal-footer .cancel-delete").addClass("disabled");$(this).button('loading');$("#modal-delete-account").find(".status").fadeOut(function(){$(this).html("処理中...<img src=\"/img/ajax-loader.gif\" class=\"loader\" />")}).fadeIn();$.ajax({url:'/ajax/delete_account',type:'post',dataType:'json',success:function(a){o=a.deleted;showDeleteCompleteMessage(a.deleted)},error:function(){showDeleteErrorMessage()},complete:function(){if(o){setTimeout(function(){redirect()},3000)}else{alert("処理がうまくいきませんでした。")}}})});$(window).scroll(function(){var a=$(document).scrollTop();if(a>=200){$(".to-page-top").fadeIn()}else{$(".to-page-top").fadeOut()}});$(".to-page-top").find("a").click(function(e){scrollToPageTop(e)});$(".list-years").find("li").mouseover(function(){$(".list-years").find("a").removeClass("btn-primary selected");$(this).find('a').addClass("btn-primary selected");$("#wrap-list-months").find("ul").css('display','none');$("#wrap-list-days").find("ul").css('display','none');var a=$(this).attr('data-date');$("#wrap-list-months").find("."+a).css('display','block')});$(".list-months").find("li").mouseover(function(){$(".list-months").find("li").find("a").removeClass("btn-primary selected");$(this).find('a').addClass("btn-primary selected");$("#wrap-list-days").find("ul").css('display','none');var a=$(this).attr('data-date');$("#wrap-list-days").find("."+a).css('display','block')});if('pushState'in history){$("#wrap-term-selectors").find("a").click(function(e){e.preventDefault();var b=$(this).attr('href');var c=$(this).attr('data-date');var d=$(this).attr('data-date-type');var f=$("#wrap-timeline");f.html("<div class=\"cover\"><span>Loading</span></div>");var g=f.find('.cover');g.css("height",200);g.animate({opacity:0.8},200);var h=location.pathname;var i=detectActionType(h);$.ajax({type:'GET',dataType:'html',url:'/ajax/switch_term',data:{"date":c,"date_type":d,"action_type":i},success:function(a){$("#wrap-main").html(a)},error:function(a){alert("読み込みに失敗しました。画面をリロードしてください")},complete:function(){scrollToPageTop(e);$("#wrap-main").fadeIn('fast');$("#wrap-term-selectors").find("a").button('complete');window.history.pushState(null,null,b)}})})}$("#wrap-list-years").find("a").click(function(){$("#wrap-list-months").find(".selected").removeClass("selected btn-primary");$("#wrap-list-days").find(".selected").removeClass("selected btn-primary");$(this).addClass("selected btn-primary")});$("#wrap-list-months").find("a").click(function(){$("#wrap-list-days").find(".selected").removeClass("selected btn-primary");$(this).addClass("selected btn-primary")});$("#wrap-list-days").find("a").click(function(){$("#wrap-list-days").find(".selected").removeClass("selected btn-primary");$(this).addClass("selected btn-primary")})});